!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.wdk=t()}}(function(){return function t(e,r,n){function i(s,u){if(!r[s]){if(!e[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var f=r[s]={exports:{}};e[s][0].call(f.exports,function(t){var r=e[s][1][t];return i(r||t)},f,f.exports,t,e,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,r){"use strict";var n=t("./wikidata_time_to_date_object"),i={};i.isNumericId=function(t){return/^[0-9]+$/.test(t)},i.isEntityId=function(t){return/^(Q|P)[0-9]+$/.test(t)},i.isItemId=function(t){return/^Q[0-9]+$/.test(t)},i.isPropertyId=function(t){return/^P[0-9]+$/.test(t)},i.getNumericId=function(t){if(!i.isEntityId(t))throw new Error("invalid wikidata id: "+t);return t.replace(/Q|P/,"")},i.wikidataTimeToDateObject=n;var o=function(t){return function(e){try{return t(e)}catch(t){return e}}},s=function(t){return n(t).getTime()},u=function(t){return n(t).toISOString()};i.wikidataTimeToEpochTime=o(s),i.wikidataTimeToISOString=o(u),e.exports=i},{"./wikidata_time_to_date_object":8}],2:[function(t,e,r){"use strict";var n=t("./helpers"),i=n.wikidataTimeToISOString,o=n.wikidataTimeToEpochTime,s=function(t){return t.value},u=function(t){return t.value.text},a=function(t,e){return c(t,e.entityPrefix)},l=function(t,e){return c(t,e.propertyPrefix)},f={item:"Q",property:"P"},c=function(t,e){var r=t.value,n=r.id||f[r["entity-type"]]+r["numeric-id"];return"string"==typeof e?e+":"+n:n},p=function(t){return parseFloat(t.value.amount)},y=function(t){return[t.value.latitude,t.value.longitude]},d=function(t,e){return m(e.timeConverter)(t.value.time)},m=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"iso";return h[t]},v=function(t){return t},h={iso:i,epoch:o,none:v},g={string:s,commonsMedia:s,url:s,"external-id":s,math:s,monolingualtext:u,"wikibase-item":a,"wikibase-property":l,time:d,quantity:p,"globe-coordinate":y,"geo-shape":s,"tabular-data":s};e.exports=function(t,e,r){return g[t](e,r)}},{"./helpers":1}],3:[function(t,e,r){"use strict";var n=t("./simplify_entity");e.exports={wd:{entities:function(t){t=t.body||t;var e=t,r=e.entities;return Object.keys(r).forEach(function(t){r[t]=n(r[t])}),r}}}},{"./simplify_entity":5}],4:[function(t,e,r){"use strict";var n=function(){function t(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(n=(s=u.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=t("./parse_claim"),s=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var i=p(r),o=i.propertyPrefix,s={};for(var a in t){var l=t[a];o&&(a=o+":"+a),s[a]=u.apply(void 0,[l].concat(r))}return s},u=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var i=p(r),o=i.keepNonTruthy,s=i.areSubSnaks;return o||s||(t=l(t)),t.map(function(t){return c.apply(void 0,[t].concat(r))}).filter(f)},a=function(t,e){var r=e.rank;return t[r]||(t[r]=[]),t[r].push(e),t},l=function(t){var e=t.reduce(a,{});return e.preferred||e.normal||[]},f=function(t){return null!=t},c=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];r=p(r);var i,u,a,l,f=r,c=f.keepQualifiers,y=f.keepReferences,d=f.keepIds,m=f.keepHashes,v=t.mainsnak;if(v){if(i=v.datatype,!(u=v.datavalue))return null}else{if(!t||!t.datavalue)return null;u=t.datavalue,i=t.datatype,t.hash?a=!0:l=!0}var h=o(i,u,r);if(a)return m?{value:h,hash:t.hash}:h;if(l)return h;if(!(c||y||d))return h;var g={value:h},b=Object.assign({},r,{areSubSnaks:!0,keepHashes:m});return c&&(g.qualifiers=s(t.qualifiers,b)),y&&(g.references=t.references.map(function(t){var e=s(t.snaks,b);return m?{snaks:e,hash:t.hash}:e})),d&&(g.id=t.id),g},p=function(t){if(null==t)return{};if(t[0]&&"object"===i(t[0]))return t[0];var e=n(t,3);return{entityPrefix:e[0],propertyPrefix:e[1],keepQualifiers:e[2]}};e.exports={simplifyClaims:s,simplifyPropertyClaims:u,simplifyClaim:c}},{"./parse_claim":2}],5:[function(t,e,r){"use strict";var n=t("./simplify_claims"),i=n.simplifyClaims,o=t("./simplify_text_attributes");e.exports=function(t){return{id:t.id,type:t.type,modified:t.modified,labels:o.labels(t.labels),descriptions:o.descriptions(t.descriptions),aliases:o.aliases(t.aliases),claims:i(t.claims),sitelinks:o.sitelinks(t.sitelinks)}}},{"./simplify_claims":4,"./simplify_text_attributes":7}],6:[function(t,e,r){"use strict";var n=function(){function t(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(n=(s=u.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e.exports=function(t){"string"==typeof t&&(t=JSON.parse(t));var e=t.head.vars,r=t.results.bindings;if(1===e.length){var o=e[0];return r.map(function(t){return i(t[o])}).filter(function(t){return null!=t})}var s=c(e),u=n(s,2),a=u[0],l=u[1];return r.map(p(a,l))};var i=function(t){if(t){var e=t.datatype;e=e&&e.replace("http://www.w3.org/2001/XMLSchema#","");return(o[t.type]||u(e))(t)}},o={uri:function(t){return f(t.value)},bnode:function(){return null}},s=function(t){return parseFloat(t.value)},u=function(t){return t=t&&t.replace("http://www.w3.org/2001/XMLSchema#",""),a[t]||l},a={decimal:s,integer:s,float:s,double:s,boolean:function(t){return"true"===t.value}},l=function(t){return t.value},f=function(t){return t.replace("http://www.wikidata.org/entity/","").replace("http://www.wikidata.org/prop/direct/","")},c=function(t){var e=[],r=[],n=!0,i=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(n=(s=u.next()).done);n=!0){var a=s.value;t.indexOf(a+"Label")>-1?e.push(a):/^\w+Label$/.test(a)||r.push(a)}}catch(t){i=!0,o=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return[e,r]},p=function(t,e){return function(r){var n={},o=!0,s=!1,u=void 0;try{for(var a,l=t[Symbol.iterator]();!(o=(a=l.next()).done);o=!0){var f=a.value,c=i(r[f]);if(null!=c){var p=r[f+"Label"]&&r[f+"Label"].value;n[f]={value:c,label:p}}}}catch(t){s=!0,u=t}finally{try{!o&&l.return&&l.return()}finally{if(s)throw u}}var y=!0,d=!1,m=void 0;try{for(var v,h=e[Symbol.iterator]();!(y=(v=h.next()).done);y=!0){var g=v.value;n[g]=i(r[g])}}catch(t){d=!0,m=t}finally{try{!y&&h.return&&h.return()}finally{if(d)throw m}}return n}}},{}],7:[function(t,e,r){"use strict";var n=function(t,e){return function(r){var n={};return Object.keys(r).forEach(function(o){var s=r[o];n[o]=t?s.map(i):s[e]}),n}},i=function(t){return t.value},o=n(!1,"value");e.exports={labels:o,descriptions:o,aliases:n(!0,"value"),sitelinks:n(!1,"title")}},{}],8:[function(t,e,r){"use strict";e.exports=function(t){var e=t[0],r=t.slice(1),i=n(e,r);return"Invalid Date"===i.toString()?s(e,r):i};var n=function(t,e){return"-"===t?o(e):i(e)},i=function(t){return new Date(t)},o=function(t){var e="-00"+t;return new Date(e)},s=function(t,e){var r=e.split("T")[0].split("-")[0];return n(t,r)}},{}],9:[function(t,e,r){"use strict";var n=e.exports={};n.searchEntities=t("./queries/search_entities"),n.getEntities=t("./queries/get_entities"),n.getManyEntities=t("./queries/get_many_entities"),n.getWikidataIdsFromSitelinks=t("./queries/get_wikidata_ids_from_sitelinks"),n.sparqlQuery=t("./queries/sparql_query"),n.getReverseClaims=t("./queries/get_reverse_claims"),n.getRevisions=t("./queries/get_revisions"),n.parse=t("./helpers/parse_responses");var i=t("./helpers/simplify_claims"),o=t("./helpers/simplify_sparql_results");n.simplify=t("../lib/helpers/simplify_text_attributes"),n.simplify.entity=t("../lib/helpers/simplify_entity"),n.simplify.claim=i.simplifyClaim,n.simplify.propertyClaims=i.simplifyPropertyClaims,n.simplify.claims=i.simplifyClaims,n.simplify.sparqlResults=o,n.simplifySparqlResults=t("./helpers/simplify_sparql_results"),Object.assign(n,i),n.getWikidataIdsFromWikipediaTitles=n.getWikidataIdsFromSitelinks,Object.assign(n,t("./helpers/helpers"))},{"../lib/helpers/simplify_entity":5,"../lib/helpers/simplify_text_attributes":7,"./helpers/helpers":1,"./helpers/parse_responses":3,"./helpers/simplify_claims":4,"./helpers/simplify_sparql_results":6,"./queries/get_entities":10,"./queries/get_many_entities":11,"./queries/get_reverse_claims":12,"./queries/get_revisions":13,"./queries/get_wikidata_ids_from_sitelinks":14,"./queries/search_entities":15,"./queries/sparql_query":16}],10:[function(t,e,r){"use strict";var n=t("../utils/build_url"),i=t("../utils/utils"),o=i.isPlainObject,s=i.forceArray,u=i.shortLang;e.exports=function(t,e,r,i){if(o(t)){var a=t;t=a.ids,e=a.languages,r=a.props,i=a.format}if(i=i||"json",!(t&&t.length>0))throw new Error("no id provided");t=s(t),t.length>50&&console.warn("getEntities accepts 50 ids max to match Wikidata API limitations:\n      this request won't get all the desired entities.\n      You can use getManyEntities instead to generate several request urls\n      to work around this limitation");var l={action:"wbgetentities",ids:t.join("|"),format:i};return e&&(e=s(e).map(u),l.languages=e.join("|")),r&&r.length>0&&(l.props=s(r).join("|")),n(l)}},{"../utils/build_url":17,"../utils/utils":19}],11:[function(t,e,r){"use strict";var n=t("./get_entities"),i=t("../utils/utils"),o=i.isPlainObject;e.exports=function(t,e,r,i){if(o(t)){var u=t;t=u.ids,e=u.languages,r=u.props,i=u.format}if(!(t instanceof Array))throw new Error("getManyEntities expects an array of ids");return s(t).map(function(t){return n(t,e,r,i)})};var s=function(t){for(var e=[];t.length>0;){var r=t.slice(0,50);t=t.slice(50),e.push(r)}return e}},{"../utils/utils":19,"./get_entities":10}],12:[function(t,e,r){"use strict";function n(t){return s.isItemId(t)?t="wd:"+t:"string"==typeof t&&(t="'"+t+"'"),t}function i(t,e,r,n){return"SELECT ?subject WHERE {\n      ?subject wdt:"+t+" "+e+" .\n      "+r+"\n    }\n    LIMIT "+n}function o(t,e,r,n){return"SELECT ?subject WHERE {\n    ?subject wdt:"+t+" ?value .\n    FILTER (lcase(?value) = "+e.toLowerCase()+")\n    "+r+"\n  }\n  LIMIT "+n}var s=t("../helpers/helpers"),u=t("./sparql_query");e.exports=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=r.limit,a=r.caseInsensitive,l=r.keepProperties;s=s||1e3;var f=a?o:i,c=n(e),p=l?"":"FILTER NOT EXISTS { ?subject rdf:type wikibase:Property . } ",y=f(t,c,p,s);return u(y)}},{"../helpers/helpers":1,"./sparql_query":16}],13:[function(t,e,r){"use strict";var n=t("../utils/build_url"),i=t("../utils/utils"),o=i.forceArray;e.exports=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=o(t);var r=1===t.length,i={action:"query",prop:"revisions"};return i.titles=t.join("|"),i.format=e.format||"json",r&&(i.rvlimit=e.limit||"max"),r&&e.start&&(i.rvstart=s(e.start)),r&&e.end&&(i.rvend=s(e.end)),n(i)};var s=function(t){return"number"==typeof t&&t<u?t:Math.trunc(new Date(t).getTime()/1e3)},u=new Date("2000-01-01").getTime()},{"../utils/build_url":17,"../utils/utils":19}],14:[function(t,e,r){"use strict";var n=t("../utils/build_url"),i=t("../utils/utils"),o=i.isPlainObject,s=i.forceArray,u=i.shortLang;e.exports=function(t,e,r,i,l){if(o(t)){var f=t;t=f.titles,e=f.sites,r=f.languages,i=f.props,l=f.format}if(l=l||"json",!(t&&t.length>0))throw new Error("no title provided");e&&e.length>0||(e=["enwiki"]),t=s(t),e=s(e).map(a),i=s(i);var c={action:"wbgetentities",titles:t.join("|"),sites:e.join("|"),format:l};return 1===e.length&&1===t.length&&(c.normalize=!0),r&&(r=s(r).map(u),c.languages=r.join("|")),i&&i.length>0&&(c.props=i.join("|")),n(c)};var a=function(t){return 2===t.length?t+"wiki":t}},{"../utils/build_url":17,"../utils/utils":19}],15:[function(t,e,r){"use strict";var n=t("../utils/build_url"),i=t("../utils/utils"),o=i.isPlainObject;e.exports=function(t,e,r,i,s){if(o(t)){var u=t;t=u.search,e=u.language,r=u.limit,i=u.format,s=u.uselang}if(!(t&&t.length>0))throw new Error("search can't be empty");return e=e||"en",s=s||e,r=r||"20",i=i||"json",n({action:"wbsearchentities",search:t,language:e,limit:r,format:i,uselang:s})}},{"../utils/build_url":17,"../utils/utils":19}],16:[function(t,e,r){"use strict";var n=t("../utils/utils"),i=n.fixedEncodeURIComponent;e.exports=function(t){return"https://query.wikidata.org/sparql?format=json&query="+i(t)}},{"../utils/utils":19}],17:[function(t,e,r){"use strict";var n="undefined"!=typeof location&&"undefined"!=typeof document,i=t(n?"./querystring_lite":"querystring");e.exports=function(t){return n&&(t.origin="*"),"https://www.wikidata.org/w/api.php?"+i.stringify(t)}},{"./querystring_lite":18,querystring:22}],18:[function(t,e,r){"use strict";e.exports={stringify:function(t){var e="";for(var r in t){var n=t[r];n&&(e+="&"+r+"="+n)}return e=e.slice(1),encodeURI?encodeURI(e):e}}},{}],19:[function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.exports={shortLang:function(t){return t.toLowerCase().split(/[^a-z]/)[0]},forceArray:function(t){return"string"==typeof t&&(t=[t]),t||[]},isPlainObject:function(t){return!(!t||"object"!==(void 0===t?"undefined":n(t))||t instanceof Array)},fixedEncodeURIComponent:function(t){return encodeURIComponent(t).replace(/[!'()*]/g,i)}};var i=function(t){return"%"+t.charCodeAt(0).toString(16)}},{}],20:[function(t,e,r){"use strict";function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,r,o){e=e||"&",r=r||"=";var s={};if("string"!=typeof t||0===t.length)return s;t=t.split(e);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var a=t.length;u>0&&a>u&&(a=u);for(var l=0;l<a;++l){var f,c,p,y,d=t[l].replace(/\+/g,"%20"),m=d.indexOf(r);m>=0?(f=d.substr(0,m),c=d.substr(m+1)):(f=d,c=""),p=decodeURIComponent(f),y=decodeURIComponent(c),n(s,p)?i(s[p])?s[p].push(y):s[p]=[s[p],y]:s[p]=y}return s};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],21:[function(t,e,r){"use strict";function n(t,e){if(t.map)return t.map(e);for(var r=[],n=0;n<t.length;n++)r.push(e(t[n],n));return r}var i=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,r,u){return e=e||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?n(s(t),function(s){var u=encodeURIComponent(i(s))+r;return o(t[s])?n(t[s],function(t){return u+encodeURIComponent(i(t))}).join(e):u+encodeURIComponent(i(t[s]))}).join(e):u?encodeURIComponent(i(u))+r+encodeURIComponent(i(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=Object.keys||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e}},{}],22:[function(t,e,r){"use strict";r.decode=r.parse=t("./decode"),r.encode=r.stringify=t("./encode")},{"./decode":20,"./encode":21}]},{},[9])(9)});
