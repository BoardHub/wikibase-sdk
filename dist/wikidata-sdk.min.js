!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.wdk=e()}}(function(){return function e(t,n,i){function r(u,a){if(!n[u]){if(!t[u]){var s="function"==typeof require&&require;if(!a&&s)return s(u,!0);if(o)return o(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[u]={exports:{}};t[u][0].call(c.exports,function(e){var n=t[u][1][e];return r(n?n:e)},c,c.exports,e,t,n,i)}return n[u].exports}for(var o="function"==typeof require&&require,u=0;u<i.length;u++)r(i[u]);return r}({1:[function(e,t,n){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,n,o){t=t||"&",n=n||"=";var u={};if("string"!=typeof e||0===e.length)return u;var a=/\+/g;e=e.split(t);var s=1e3;o&&"number"==typeof o.maxKeys&&(s=o.maxKeys);var l=e.length;s>0&&l>s&&(l=s);for(var c=0;l>c;++c){var f,d,p,m,h=e[c].replace(a,"%20"),v=h.indexOf(n);v>=0?(f=h.substr(0,v),d=h.substr(v+1)):(f=h,d=""),p=decodeURIComponent(f),m=decodeURIComponent(d),i(u,p)?r(u[p])?u[p].push(m):u[p]=[u[p],m]:u[p]=m}return u};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],2:[function(e,t,n){"use strict";function i(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(u(e),function(u){var a=encodeURIComponent(r(u))+n;return o(e[u])?i(e[u],function(e){return a+encodeURIComponent(r(e))}).join(t):a+encodeURIComponent(r(e[u]))}).join(t):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},u=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},{}],3:[function(e,t,n){"use strict";n.decode=n.parse=e("./decode"),n.encode=n.stringify=e("./encode")},{"./decode":1,"./encode":2}],4:[function(e,t,n){(function(){var n,i;i=e("./wikidata_time_to_date_object"),n={},n.isNumericId=function(e){return/^[0-9]+$/.test(e)},n.isWikidataId=function(e){return/^(Q|P)[0-9]+$/.test(e)},n.isWikidataEntityId=function(e){return/^Q[0-9]+$/.test(e)},n.isWikidataPropertyId=function(e){return/^P[0-9]+$/.test(e)},n.normalizeId=function(e,t,i){if(null==i&&(i="Q"),n.isNumericId(e))return t?e:""+i+e;if(n.isWikidataId(e))return t?e.slice(1):e;throw new Error("invalid id")},n.getNumericId=function(e){if(!n.isWikidataId(e))throw new Error("invalid wikidata id: "+e);return e.replace(/Q|P/,"")},n.normalizeIds=function(e,t,i){return null==i&&(i="Q"),e.map(function(e){return n.normalizeId(e,t,i)})},n.wikidataTimeToDateObject=i,n.wikidataTimeToEpochTime=function(e){return i(e).getTime()},n.wikidataTimeToISOString=function(e){return i(e).toISOString()},n.normalizeWikidataTime=n.wikidataTimeToEpochTime,t.exports=n}).call(this)},{"./wikidata_time_to_date_object":7}],5:[function(e,t,n){(function(){var n,i;i=e("./helpers"),n=e("./simplify_claims"),t.exports={wd:{entities:function(e){var t,i,r;e=e.body||e,t=e.entities;for(r in t)i=t[r],i.claims=n(i.claims);return t}},wdq:{entities:function(e){var t;return e=e.body||e,null!=(t=e.items)?t.map(function(e){return i.normalizeId(e)}):void 0}}}}).call(this)},{"./helpers":4,"./simplify_claims":6}],6:[function(e,t,n){(function(){var n,i;i=e("./helpers"),t.exports=function(e){var t,i,r;r={};for(i in e)t=e[i],r[i]=t.map(n);return r},n=function(e){var t,n,r,o,u;if(r=e.mainsnak,null!=r){switch(o=[r.datatype,r.datavalue],t=o[0],n=o[1],t){case"string":case"commonsMedia":case"url":u=n.value;break;case"monolingualtext":u=n.value.text;break;case"wikibase-item":u="Q"+n.value["numeric-id"];break;case"time":u=i.normalizeWikidataTime(n.value.time);break;default:u=null}return u}}}).call(this)},{"./helpers":4}],7:[function(e,t,n){(function(){var e,n,i,r;t.exports=function(t){var n,r,o;return o=t[0],r=t.slice(1),n=e(o,r),"Invalid Date"===n.toString()?i(o,r):n},e=function(e,t){return"-"===e?n(t):r(t)},r=function(e){return new Date(e)},n=function(e){var t;return t="-00"+e,new Date(t)},i=function(t,n){var i,r,o,u;return o=n.split("T")[0].split("-"),u=o[0],r=o[1],i=o[2],e(t,u)}}).call(this)},{}],8:[function(e,t,n){(function(){var n,i,r;n=e("../utils/build_url"),i=e("../helpers/helpers"),r={claim:function(e,t){return e=i.normalizeId(e,!0),t=i.normalizeId(t,!0),n("wdq",{q:"CLAIM["+e+":"+t+"]"})},string:function(e,t){return e=i.normalizeId(e,!0),n("wdq",{q:"STRING["+e+":"+t+"]"})}},t.exports=function(e,t){return i.isWikidataEntityId(t)?r.claim(e,t):r.string(e,t)}}).call(this)},{"../helpers/helpers":4,"../utils/build_url":11}],9:[function(e,t,n){(function(){var n,i,r,o,u,a=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};u=e("../helpers/helpers"),n=e("../utils/build_url"),r=e("../utils/utils"),i=r.forceArray,o=r.shortLang,t.exports=function(e,t,r,s){var l;if(null==t&&(t=["en"]),null==s&&(s="json"),null==e&&0!==e.length)throw new Error("no id provided");return e=u.normalizeIds(i(e)),t=i(t).map(o),r=i(r),a.call(t,"en")<0&&t.push("en"),l={action:"wbgetentities",ids:e.join("|"),languages:t.join("|"),format:s},(null!=r?r.length:void 0)>0&&(l.props=r.join("|")),n("wikidata",l)}}).call(this)},{"../helpers/helpers":4,"../utils/build_url":11,"../utils/utils":13}],10:[function(e,t,n){(function(){var n,i;i=e("../helpers/helpers"),n=e("../utils/build_url"),t.exports=function(e,t,i,r){if(null==t&&(t="en"),null==i&&(i="20"),null==r&&(r="json"),!((null!=e?e.length:void 0)>0))throw new Error("search can't be undefined");return n("wikidata",{action:"wbsearchentities",search:e,language:t,limit:i,format:r})}}).call(this)},{"../helpers/helpers":4,"../utils/build_url":11}],11:[function(e,t,n){(function(){var n,i,r;try{i=e("querystring")}catch(o){n=o,i=e("./querystring_lite")}r={wikidata:"https://www.wikidata.org/w/api.php",commons:"http://commons.wikimedia.org",wdq:"http://wdq.wmflabs.org/api"},t.exports=function(e,t){return r[e]+"?"+i.stringify(t)}}).call(this)},{"./querystring_lite":12,querystring:3}],12:[function(e,t,n){(function(){t.exports={stringify:function(e){var t,n,i;n="";for(t in e)i=e[t],null!=i&&(n+="&"+t+"="+i);return n=n.slice(1),"undefined"!=typeof encodeURI&&null!==encodeURI?encodeURI(n):n}}}).call(this)},{}],13:[function(e,t,n){(function(){t.exports={shortLang:function(e){return e.slice(0,3)},forceArray:function(e){return"string"==typeof e&&(e=[e]),e||[]}}}).call(this)},{}],14:[function(e,t,n){(function(){var n,i,r,o;t.exports=o={},n=e("./helpers/helpers"),o.searchEntities=e("./queries/wikidata_search_entities"),o.getEntities=e("./queries/wikidata_get_entities"),o.getReverseClaims=e("./queries/wdq_get_reverse_claims"),o.simplifyClaims=e("./helpers/simplify_claims"),o.parse=e("./helpers/parse_responses"),o.helpers=n;for(i in n)r=n[i],o[i]=r}).call(this)},{"./helpers/helpers":4,"./helpers/parse_responses":5,"./helpers/simplify_claims":6,"./queries/wdq_get_reverse_claims":8,"./queries/wikidata_get_entities":9,"./queries/wikidata_search_entities":10}]},{},[14])(14)});
